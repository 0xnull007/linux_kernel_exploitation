clear
disassemble main
clear
quit
checksec
clear
quit
info function
b main
r
disassemble getmessage 
quit
b main
r
quit
b main
r
quit
clear
disassemble main
quit
clear
info function
quit
clear
b 18
ls -l
disassemble main
clear
run
ni
si
quit
b getmessage 
r
vmmap
quit
r
vmmap
clear
r
vmmap
quit
clear
info function
vmmap
b getmessage
clear
run
vmmap
aslr on
clear
r
disassemble main
disassemble getmessage 
vmmap
info function
disassemble main
vmmap
clear
disassemble getmessage
vmmap
clear
run
ni
ni
vmmap
asmsearch "pop rsi"
asmsearch "pop rsi; ret"
asmsearch "pop rsi"
quit
clear
info function
clear
b main
run
clear
quit
clear
info function
quit
checksec
clear
quit
r
clear
quit
r
aslr on
clear
b getmessage 
clear
r
vmmap
quit
b getmessage 
r
reverse-next
clear
r
vmmap
quit
b getmessage 
r
aslr on
r
b getmessage 
r
clear
quit
clear
info function
disassemble getmessage 
disassemble 0x1040
x/x 0x3fc0
quit
info function
quit
clear
pattern_create 100 offer
clear
run < offer 
pattern_offset AA0AAFAAb
quit
clear
info functions 
aslr on
b main
run
vmmap
quit
aslr on
clear
b main
r
vmmap
quit
clear
aslr on
clear
ls -l
b main
clear
r
vmmap
quit
r
vmmap
clear
quit
clear
info function
vmmap
quit
clear
ls -l
info function
quit
info function
quit
clear
info function
disassemble 0x1040
quit
clear
cat offer
clear
r < offer
pattern_offset AA0AAFA
vmmap
quit
clear
disassemble main
disassemble 0x1040
info function
quit
clear
file vul
clear
disassemble main
info function
disassemble getmessage
b *getmessage + 78
clear
r
quit
aslr on
r
file vul
r
vmmap
quit
file vul
aslr on
b *getmessage + 78
r
vmmap
quit
clear
disassemble getmessage 
b *getmessage + 76
r
disassemble 0x1040
info function
disassemble getmessage 
disassemble 0x555555555040
x/x 555555557fc0
x/x 0x555555557fc0
vmmap
quit
set show-tips off
q
b main 
r
print _start
set disable-randomization off
r
print _start
q
set disable-randomization off
b main
r
n
r
disass amin
disass main
b *0x0000559b4677b1ef
c
ni
ni
q
disass main
q
vmmap
q
disass getmessage 
q
b main
b getmessage 
r
ni
ni
c
ni
q
disass getmessage 
finish 
ni
stack
x/20gx $rsp
disass 0x00007f5d633c041b
q
finish 
ni
c
q
